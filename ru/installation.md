# Установка

<!-- NavigationBegin -->
- [Требования к серверу](#requirements)
- [Создание нового проекта](#create-project)
- [Базовая конфигурация](#configuration)
- [Настройка среды окружения](#environment)
- [Установка с использованием Docker](#install-docker)
    - [Docker на macOS](#install-docker-macos)
    - [Docker на Windows](#install-docker-windows)
    - [Docker на Linux](#install-docker-linux)
    - [Выбор сервисов Docker](#install-docker-services)
- [Что дальше?](#next-step)
<!-- NavigationEnd -->



<a name="requirements"></a>
## Требования к серверу

Фреймворк Imhotep имеет следующие требования:

- PHP >= 8.2
- MCrypt PHP Extension
- MbString PHP Extension
- Gd PHP Extension
- Curl PHP Extension
- Composer

<a name="create-project"></a>
## Создание нового проекта

Прежде чем приступить к созданию вашего первого проекта Imhotep, убедитесь, что на вашем сервере установлены PHP и [Composer](https://getcomposer.org). Если вы используете MacOS, то можете легко установить PHP и Composer с помощью [Homebrew](https://brew.sh/).

После установки PHP и Composer, вы можете создать новый проект Imhotep, используя команду Composer `create-project`:

```
composer create-project imhotep/imhotep example-app
```

Как только проект будет создан, вы сможете запустить локальный сервер разработки Imhotep, выполнив команду `php server` в корневом каталоге проекта:

```bash
cd example-app
php server
```

После успешного запуска локального сервера в консоли появится информация об успешном запуске и ссылка на ваше приложение:

```bash
> PHP 8.X.X Development Server (http://127.0.0.1:8000) started
```

<a name="configuration"></a>
## Базовая конфигурация

Все файлы конфигурации Imhotep размещены в каталоге `config`. Внутри каждого файла вы найдете описание, которое поможет вам лучше понять доступные параметры настроек.

По умолчанию Imhotep имеет конфигурацию, которая позволяет вам начать разработку прямо сейчас! Однако перед тем как приступить, мы рекомендуем ознакомиться с файлом `config/app.php` и настроить индивидуальные параметры вашего проекта, такие как название, адрес, язык и часовой пояс.

<a name="environment"></a>
## Настройка среды окружения

В зависимости от того, где работает ваше приложение — на локальном компьютере или на производственном сервере — некоторые параметры конфигурации могут различаться. Например, это касается настроек доступа к базе данных.

Все важные параметры конфигурации хранятся в файле `.env`, который находится в корне вашего приложения.

Не рекомендуется включать файл `.env` в git-репозиторий вашего приложения. Это связано с тем, что другие разработчики или серверы могут потребовать изменения параметров окружения. Кроме того, в этом файле содержатся конфиденциальные данные доступа, и размещение их в репозитории может стать угрозой безопасности вашего приложения в случае их хищения злоумышленниками.

<a name="install-docker"></a>
## Установка с использованием Docker

Что-бы сделать установку максимально простой, независимо от операционной системы, существует вариант запуска приложения Imhotep через [Docker](https://www.docker.com).

Docker — это инструмент, который помогает упаковывать программы и все необходимые для их работы файлы в специальные «контейнеры». Когда программа запускается в контейнере, она работает так же, как если бы она была установлена на отдельном компьютере. Контейнеры позволяют запускать программы на разных операционных системах без необходимости устанавливать все их зависимости заново. Это упрощает разработку, тестирование и запуск приложений. Для начала работы, установите [Docker Desktop](https://www.docker.com/products/docker-desktop/).

Пакет [Imhotep Docker](https://github.com/imhotep-php/docker) - это простой интерфейс командной строки для взаимодействия приложения Imhotep с Docker. С его помощью вы можете легко выбрать версию PHP, добавить базу данных MySQL, Postgres и Redis, не имея опыта работы с Docker.

> Являетесь экспертом по Docker? Для вас всегда будет доступен файл `docker-compose.yml`.

<a name="install-docker-macos"></a>
### Docker на macOS

Для развертывания приложения Imhotep на Mac, установите [Docker Desktop](https://www.docker.com/products/docker-desktop/) если он еще не установлен и запустите простую команду в терминале (измените `example-app` на название вашего приложения, название должно содержать латинские символы, цифры, дефис и подчеркивание):

```shell
curl -s "https://install.imhotep.dev/example-app" | bash
```

Папка с установленным приложением будет создана в том каталоге, из которого вы выполнили эту команду.

Установка может занять несколько минут, после чего можно будет перейти в папку с приложением и запустить его:

```shell
cd example-app

./vendor/bin/docker up
```

После запуска Docker, запустите миграции базы данных:

```shell
./vendor/bin/docker imhotep migrate
```

Теперь можно открыть приложения в браузере по адресу http://localhost.

<a name="install-docker-windows"></a>
### Docker на Windows

Для развертывания приложения Imhotep на Windows, установите [Docker Desktop](https://www.docker.com/products/docker-desktop/) если он еще не установлен. Далее убедитесь, что установлен и включен Windows Subsystem for Linux 2 (WSL2). WSL позволяет запускать исполняемые файлы Linux на Windows 10, инструкция по установке и настройке доступна в документации [среды разработки Microsoft](https://learn.microsoft.com/ru-ru/windows/wsl/install).

> После установки и включения WSL2 убедитесь, что Docker Desktop [настроен для использования бэкенда WSL2](https://docs.docker.com/desktop/features/wsl/).

Теперь вы можете развернуть приложения Imhotep, для этого запустите простую команду в терминале (измените `example-app` на название вашего приложения, название должно содержать латинские символы, цифры, дефис и подчеркивание):

```shell
curl -s "https://install.imhotep.dev/example-app" | bash
```

Папка с установленным приложением будет создана в том каталоге, из которого вы выполнили эту команду.

Установка может занять несколько минут, после чего можно будет перейти в папку с приложением и запустить его:

```shell
cd example-app

./vendor/bin/docker up
```

После запуска Docker, запустите миграции базы данных:

```shell
./vendor/bin/docker imhotep migrate
```

Теперь можно открыть приложения в браузере по адресу http://localhost.

<a name="install-docker-linux"></a>
### Docker на Linux

Для развертывания приложения Imhotep на Mac, установите [Docker Desktop](https://www.docker.com/products/docker-desktop/) или [Docker Compose](https://docs.docker.com/compose/install/) если еще не установлен.

Если вы решили использовать Docker Desktop, выполните команду:

```shell
docker context use default
```

Теперь запустите простую команду в терминале (измените `example-app` на название вашего приложения, название должно содержать латинские символы, цифры, дефис и подчеркивание):

```shell
curl -s "https://install.imhotep.dev/example-app" | bash
```

Папка с установленным приложением будет создана в том каталоге, из которого вы выполнили эту команду.

Установка может занять несколько минут, после чего можно будет перейти в папку с приложением и запустить его:

```shell
cd example-app

./vendor/bin/docker up
```

После запуска Docker, запустите миграции базы данных:

```shell
./vendor/bin/docker imhotep migrate
```

Теперь можно открыть приложения в браузере по адресу http://localhost.

<a name="install-docker-services"></a>
### Выбор сервисов Docker

При развертывании нового приложения Imhotep через Docker, вы можете использовать переменную `with` в строке запроса для выбора необходимых для установки сервисов:

```shell
curl -s "https://install.imhotep.dev/example-app?with=mysql,redis" | bash
```

Доступные сервисы для выбора: `mysql`, `postgres`, `redis`, `memcached`. По умолчанию будут установлены `mariadb` и `redis`.


<a name="next-step"></a>
## Что дальше?

После создания первого Imhotep проекта, рекомендуем ознакомиться с основными принципами работы Imhotep, изучив следующие материалы:

- [Конфигурирование](/docs/configuration)
- [Структура каталогов](/docs/structure)
- [Request Lifecycle](/docs/lifecycle)
- [Service Container](/docs/container)